"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[5898],{15747:(e,t,r)=>{r.d(t,{d:()=>u});class n{constructor(e){this.fullDate=e}getTimeInSec(){const e=this.fullDate.substring(0,10),t=this.fullDate.substring(11,28),r=parseInt(e.substring(0,4),10),n=e.length>=7?parseInt(e.substring(5,7),10):void 0,i=e.length>=10?parseInt(e.substring(8,10),10):void 0;if(isNaN(r)||void 0!==n&&isNaN(n)||void 0!==i&&isNaN(i)||r>3e3||n&&(n<1||n>12)||i&&(i<1||i>31))throw new Error(`invalid date '${e}'`);const a=new Date(`${e}T00:00:00.000000Z`),s=parseInt(t.substring(0,2),10),o=t.length>=5?parseInt(t.substring(3,5),10):void 0,c=t.length>=8?parseInt(t.substring(6,8),10):void 0,l=t.substring(9,15),u=l?parseInt(l,10)*Math.pow(10,-l.length):void 0;if(isNaN(s)||void 0!==o&&isNaN(o)||void 0!==c&&isNaN(c)||void 0!==u&&isNaN(u)||s<0||s>23||o&&(o<0||o>59)||c&&(c<0||c>59)||u&&(u<0||u>999999))throw new Error(`invalid time '${t}'`);let d=a.getTime()/1e3;return d+=3600*s,void 0!==o&&(d+=60*o),void 0!==c&&(d+=c),void 0!==u&&(d+=u),d}getTimeInMicroSec(){return 1e6*this.getTimeInSec()}}function i(e,t){const r=`${t.hours||"00"}`.padStart(2,"0"),i=`${t.minutes||"00"}`.padStart(2,"0"),a=`${t.seconds||"00"}`.padStart(2,"0"),s=`${e.month}`.padStart(2,"0"),o=`${e.day}`.padStart(2,"0"),c=`${t.fractionalSeconds||"000000"}`.padEnd(6,"0"),l=`${e.year}-${s}-${o}`;return new n(`${l}${`T${r}:${i}:${a}.${c}Z`}`)}function a(e){if(null==e||8!==e.length||"string"!=typeof e)throw new Error(`invalid DA '${e}'`);const t=parseInt(e.substring(0,4),10),r=parseInt(e.substring(4,6),10),n=parseInt(e.substring(6,8),10);if(!0!=(i=n,a=r,s=t,!isNaN(s)&&a>0&&a<=12&&i>0&&i<=function(e,t){switch(e){case 2:return t%4==0&&t%100||t%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(a,s)))throw new Error(`invalid DA '${e}'`);var i,a,s;return{year:t,month:r,day:n}}function s(e){if(null==e||e.length<2||"string"!=typeof e)throw new Error(`invalid TM '${e}'`);const t=parseInt(e.substring(0,2),10),r=e.length>=4?parseInt(e.substring(2,4),10):void 0,n=e.length>=6?parseInt(e.substring(4,6),10):void 0,i=e.length>=8?e.substring(7,13):void 0,a=i?parseInt(i,10)*Math.pow(10,6-i.length):void 0;if(isNaN(t)||void 0!==r&&isNaN(r)||void 0!==n&&isNaN(n)||void 0!==a&&isNaN(a)||t<0||t>23||r&&(r<0||r>59)||n&&(n<0||n>59)||a&&(a<0||a>999999))throw new Error(`invalid TM '${e}'`);return{hours:t,minutes:r,seconds:n,fractionalSeconds:a}}function o(e){if(null==e)throw new Error("dateTimeToFullDateInterface : dateTime not defined.");return i(a(e.substring(0,8)),s(e.substring(8)))}function c(e){const{RadionuclideTotalDose:t,RadionuclideHalfLife:r,RadiopharmaceuticalStartDateTime:c,RadiopharmaceuticalStartTime:l,SeriesDate:u}=e[0];if(null==t)throw new Error("calculateDecayCorrection : RadionuclideTotalDose value not found.");if(null==r)throw new Error("calculateDecayCorrection : RadionuclideHalfLife value not found.");const d=function(e){const{SeriesDate:t,SeriesTime:r,GEPrivatePostInjectionDateTime:c}=e[0],l=new Array(e.length),u=i(a(t),s(r));let d=new n("3000-01-01T00:00:00.000000Z"),f=d.getTimeInSec();if(e.forEach((e=>{const{AcquisitionDate:t,AcquisitionTime:r}=e,n=i(a(t),s(r));d=d.getTimeInSec()>=f||n.getTimeInSec()<d.getTimeInSec()?n:d})),d.getTimeInSec()>=f)throw new Error("Earliest acquisition time or date could not be parsed.");return u.getTimeInSec()<=d.getTimeInSec()?l.fill(u):c?l.fill(o(c)):l.fill(d)}(e),f=function(e){const{RadiopharmaceuticalStartDateTime:t,RadiopharmaceuticalStartTime:r,SeriesDate:n}=e;let c,l;if(t)return o(t);if(r&&n)return c=s(r),l=a(n),i(l,c);throw new Error(`Invalid input: ${e}`)}({RadiopharmaceuticalStartDateTime:c,RadiopharmaceuticalStartTime:l,SeriesDate:u});return e.map(((e,n)=>{const i=d[n].getTimeInSec()-f.getTimeInSec();if(i<0)throw new Error("Decay time cannot be less than zero");return 1/(t*Math.pow(2,-i/r))}))}const l=(e,t)=>e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every(((e,r)=>e===t[r]));function u(e){const{CorrectedImage:t,Units:r,PhilipsPETPrivateGroup:n,PatientWeight:i,PatientSex:a,PatientSize:s}=e[0];if(!t.includes("ATTN")||!t.includes("DECY"))throw new Error(`CorrectedImage must contain "ATTN" and "DECY": ${t}`);if(!e.every((n=>n.Units===r&&l(n.CorrectedImage,t)&&n.PatientWeight===i&&n.PatientSex===a&&n.PatientSize===s&&n.RadionuclideHalfLife===e[0].RadionuclideHalfLife&&n.RadionuclideTotalDose===e[0].RadionuclideTotalDose&&n.DecayCorrection===e[0].DecayCorrection&&n.SeriesDate===e[0].SeriesDate&&n.SeriesTime===e[0].SeriesTime)))throw new Error("The set of instances does not appear to come from one Series. Every instance must have identical values for series-level metadata properties");if(!i)throw new Error("PatientWeight value is missing. It is not possible to calculate the SUV factors");let o=new Array(e.length);o=c(e);let u=new Array(e.length);const d=1e3*i;if("BQML"===r)u=o.map((function(e){return e*d}));else if("CNTS"===r){const t=e.every((e=>{var t,r,n;return e.PhilipsPETPrivateGroup&&null!==(null===(t=e.PhilipsPETPrivateGroup)||void 0===t?void 0:t.SUVScaleFactor)&&void 0!==(null===(r=e.PhilipsPETPrivateGroup)||void 0===r?void 0:r.SUVScaleFactor)&&0!==(null===(n=e.PhilipsPETPrivateGroup)||void 0===n?void 0:n.SUVScaleFactor)})),r=e.every((e=>{var t,r,n;return e.PhilipsPETPrivateGroup&&!(null!==(t=e.PhilipsPETPrivateGroup)&&void 0!==t&&t.SUVScaleFactor)&&void 0!==(null===(r=e.PhilipsPETPrivateGroup)||void 0===r?void 0:r.ActivityConcentrationScaleFactor)&&0!==(null===(n=e.PhilipsPETPrivateGroup)||void 0===n?void 0:n.ActivityConcentrationScaleFactor)}));if(t)u=e.map((e=>e.PhilipsPETPrivateGroup.SUVScaleFactor));else{if(!r)throw new Error(`Units are in CNTS, but PhilipsPETPrivateGroup has invalid values: ${JSON.stringify(n)}`);u=e.map(((e,t)=>e.PhilipsPETPrivateGroup.ActivityConcentrationScaleFactor*o[t]*d))}}else{if("GML"!==r)throw new Error(`Units has an invalid value: ${r}`);u.fill(1)}let f,p,h;if(null==s)console.warn("PatientSize value is missing. It is not possible to calculate the SUV bsa factors");else{f=function(e){const{PatientWeight:t,PatientSize:r}=e;return Math.pow(t,.425)*Math.pow(100*r,.725)*71.84}({PatientWeight:i,PatientSize:s})}if(null==s)console.warn("PatientSize value is missing. It is not possible to calculate the SUV lbm factors");else if(null==a)console.warn("PatientSex value is missing. It is not possible to calculate the SUV lbm factors");else{const e={PatientWeight:i,PatientSex:a,PatientSize:s};p=function(e){const{PatientSex:t,PatientWeight:r,PatientSize:n}=e;let i;const a=Math.pow(r/(100*n),2);if("F"===t)i=1.07*r-148*a;else{if("M"!==t)throw new Error(`PatientSex is an invalid value: ${t}`);i=1.1*r-120*a}return 1e3*i}(e),h=function(e){const{PatientSex:t,PatientWeight:r,PatientSize:n}=e;let i;const a=r/Math.pow(n,2);if("F"===t)i=9270*r/(8780+244*a);else{if("M"!==t)throw new Error(`PatientSex is an invalid value: ${t}`);i=9270*r/(6680+216*a)}return 1e3*i}(e)}return u.map((function(e,t){const r={suvbw:e};return f&&(r.suvbsa=o[t]*f),p&&(r.suvlbm=o[t]*p),h&&(r.suvlbmJanma=o[t]*h),r}))}},97604:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=n.key,a=void 0,"symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"))?a:String(a)),n)}var i,a}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e){for(var t=new Uint8Array(e.length),r=0,n=e.length;r<n;r++)t[r]=e.charCodeAt(r);return t}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r+t.length>e.length)return!1;for(var n=r,i=0;i<t.length;i++){if(t[i]!==e[n])return!1;n+=1}return!0}function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,i=e.length;n&&(i=Math.min(r+n,e.length));for(var a=r;a<i;a++)if(e[a]===t[0]&&c(e,t,a))return a;return-1}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}(),r="Content-Type: ".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/dicom"),n="\r\n--".concat(t,"\r\n").concat(r,"\r\n\r\n"),i="\r\n--".concat(t,"--"),a=o(n),s=o(i),c=a.length,l=s.length,u=0,d=e.map((function(e){var t=new Uint8Array(e),r=t.length;return u+=c+r+l,t})),f=new Uint8Array(u);f.set(a,0);var p=0;return d.forEach((function(e){f.set(a,p),f.set(e,p+c),p+=c+e.length})),f.set(s,p),{data:f.buffer,boundary:t}}function d(e){var t=ArrayBuffer.isView(e)?e:new Uint8Array(e),r=o("\r\n\r\n"),n=l(t,r,0,1e3);if(-1===n)throw new Error("Response message has no multipart mime header");var i=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(arguments.length>2?arguments[2]:void 0)||e.length-t,n="",i=t;i<t+r;i++)n+=String.fromCharCode(e[i]);return n}(t,0,n),a=function(e){for(var t=e.split("\r\n"),r=0;r<t.length;r++)if("--"===t[r].substr(0,2))return t[r];return null}(i);if(!a)throw new Error("Header of response message does not specify boundary");for(var s,c=o(a),u=c.length,d=[],f=u;-1!==s&&-1!==(s=l(t,c,f));){var p=l(t,r,f,1e3);if(-1===p)throw new Error("Response message part has no mime header");f=p+r.length;var h=e.slice(f,s-2);d.push(h),f=s+u}return d}function f(e){return"object"===n(e)&&null!==e}function p(e){return 0===Object.keys(e).length&&e.constructor===Object}r.d(t,{api:()=>g});var h=function(e){return e[0]},v={DICOM:"application/dicom",DICOM_JSON:"application/dicom+json",OCTET_STREAM:"application/octet-stream",PDF:"application/pdf",JPEG:"image/jpeg",PNG:"image/png"},m=function(){};var g={DICOMwebClient:function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseURL=t.url,this.baseURL||console.error("no DICOMweb base url provided - calls that require a URL will fail"),"username"in t&&(this.username=t.username,"password"in t||console.error("no password provided to authenticate with DICOMweb service"),this.password=t.password),"qidoURLPrefix"in t?(m("use URL prefix for QIDO-RS: ".concat(t.qidoURLPrefix)),this.qidoURL="".concat(this.baseURL,"/").concat(t.qidoURLPrefix)):this.qidoURL=this.baseURL,"wadoURLPrefix"in t?(m("use URL prefix for WADO-RS: ".concat(t.wadoURLPrefix)),this.wadoURL="".concat(this.baseURL,"/").concat(t.wadoURLPrefix)):this.wadoURL=this.baseURL,"stowURLPrefix"in t?(m("use URL prefix for STOW-RS: ".concat(t.stowURLPrefix)),this.stowURL="".concat(this.baseURL,"/").concat(t.stowURLPrefix)):this.stowURL=this.baseURL,t.singlepart?(m("use singlepart",t.singlepart),this.singlepart=!0===t.singlepart?"bulkdata,video,image":t.singlepart):this.singlepart="","requestHooks"in t&&(this.requestHooks=t.requestHooks),this.headers=t.headers||{},this.errorInterceptor=t.errorInterceptor||function(){},this.verbose=!1!==t.verbose,this.setDebug(t.debug)}var t,r,s;return t=e,r=[{key:"setDebug",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.debugLevel=!!e,m=t||e?console.log:function(){}}},{key:"getDebug",value:function(){return this.debugLevel}},{key:"setVerbose",value:function(e){this.verbose=e}},{key:"getVerbose",value:function(){return this.verbose}},{key:"_httpRequest",value:function(e,t){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=this.errorInterceptor,o=this.requestHooks;return new Promise((function(c,l){var u=a.request?a.request:new XMLHttpRequest;u.open(t,e,!0),"responseType"in a&&(u.responseType=a.responseType),"object"===n(i)&&Object.keys(i).forEach((function(e){u.setRequestHeader(e,i[e])}));var f,p=r.headers;if(Object.keys(p).forEach((function(e){u.setRequestHeader(e,p[e])})),u.onloadstart=function(){m("upload started: ",e)},u.onloadend=function(){m("upload finished")},u.onreadystatechange=function(){if(4===u.readyState)if(200===u.status){var e=u.getResponseHeader("Content-Type");e&&-1!==e.indexOf("multipart")?c(d(u.response)):"arraybuffer"===u.responseType?c([u.response]):c(u.response)}else if(202===u.status)r.verbose&&console.warn("some resources already existed: ",u),c(u.response);else if(204===u.status)r.verbose&&console.warn("empty response for request: ",u),c([]);else{var t=new Error("request failed");t.request=u,t.response=u.response,t.status=u.status,r.verbose&&(console.error("request failed: ",u),console.error(t),console.error(t.response)),s(t),l(t)}},"progressCallback"in a&&"function"==typeof a.progressCallback&&(u.onprogress=a.progressCallback),o&&function(e){var t=Array.isArray(e)&&e.every((function(e){return"function"==typeof e&&2===e.length}));return t||console.warn("Request hooks should have the following signature: function requestHook(request, metadata) { return request; }"),t}(o)){var h=Object.assign({},i,r.headers),v={method:t,url:e,headers:h},g=(f=o,function(e){return f.reduce((function(e,t){return t(e,v)}),e)});u=g(u)}"withCredentials"in a&&a.withCredentials&&(u.withCredentials=!0),"data"in a?u.send(a.data):u.send()}))}},{key:"_httpGet",value:function(e,t,r,n,i){return this._httpRequest(e,"get",t,{responseType:r,progressCallback:n,withCredentials:i})}},{key:"_httpGetApplicationJson",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=t;"object"===n(r)&&(p(r)||(s+=e._parseQueryParameters(r)));var o={Accept:v.DICOM_JSON};return this._httpGet(s,o,"json",i,a)}},{key:"_httpGetApplicationPdf",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=t;"object"===n(r)&&(p(r)||(s+=e._parseQueryParameters(r)));var o={Accept:v.PDF};return this._httpGet(s,o,"json",i,a)}},{key:"_httpGetImage",value:function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=t;"object"===n(i)&&(p(i)||(o+=e._parseQueryParameters(i)));var c={Accept:e._buildAcceptHeaderFieldValue(r,["image/","image/*","image/jpeg","image/jp2","image/gif","image/png"])};return this._httpGet(o,c,"arraybuffer",a,s)}},{key:"_httpGetText",value:function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=t;"object"===n(i)&&(p(i)||(o+=e._parseQueryParameters(i)));var c={Accept:e._buildAcceptHeaderFieldValue(r,["text/","text/*","text/html","text/plain","text/rtf","text/xml"])};return this._httpGet(o,c,"arraybuffer",a,s)}},{key:"_httpGetVideo",value:function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=t;"object"===n(i)&&(p(i)||(o+=e._parseQueryParameters(i)));var c={Accept:e._buildAcceptHeaderFieldValue(r,["video/","video/*","video/mpeg","video/mp4","video/H265"])};return this._httpGet(o,c,"arraybuffer",a,s)}},{key:"_httpGetMultipartImage",value:function(t,r,n,i){var a,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c={};return arguments.length>4&&void 0!==arguments[4]&&arguments[4]?a=["image/jpeg","image/gif","image/png","image/jp2"]:(a={"1.2.840.10008.1.2.5":["image/x-dicom-rle"],"1.2.840.10008.1.2.4.50":["image/jpeg"],"1.2.840.10008.1.2.4.51":["image/jpeg"],"1.2.840.10008.1.2.4.57":["image/jpeg"],"1.2.840.10008.1.2.4.70":["image/jpeg"],"1.2.840.10008.1.2.4.80":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.81":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.90":["image/jp2"],"1.2.840.10008.1.2.4.91":["image/jp2"],"1.2.840.10008.1.2.4.92":["image/jpx"],"1.2.840.10008.1.2.4.93":["image/jpx"]},n&&(c.Range=e._buildRangeHeaderFieldValue(n))),c.Accept=e._buildMultipartAcceptHeaderFieldValue(r,a),this._httpGet(t,c,"arraybuffer",s,o)}},{key:"_httpGetMultipartVideo",value:function(t,r,n,i){var a,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c={};return arguments.length>4&&void 0!==arguments[4]&&arguments[4]?a=["video/","video/*","video/mpeg2","video/mp4","video/H265"]:(a={"1.2.840.10008.1.2.4.100":["video/mpeg2"],"1.2.840.10008.1.2.4.101":["video/mpeg2"],"1.2.840.10008.1.2.4.102":["video/mp4"],"1.2.840.10008.1.2.4.103":["video/mp4"],"1.2.840.10008.1.2.4.104":["video/mp4"],"1.2.840.10008.1.2.4.105":["video/mp4"],"1.2.840.10008.1.2.4.106":["video/mp4"]},n&&(c.Range=e._buildRangeHeaderFieldValue(n))),c.Accept=e._buildMultipartAcceptHeaderFieldValue(r,a),this._httpGet(t,c,"arraybuffer",s,o)}},{key:"_httpGetMultipartApplicationDicom",value:function(t,r,n,i,a){var s={},o="application/dicom",c={"1.2.840.10008.1.2.1":[o],"1.2.840.10008.1.2.5":[o],"1.2.840.10008.1.2.4.50":[o],"1.2.840.10008.1.2.4.51":[o],"1.2.840.10008.1.2.4.57":[o],"1.2.840.10008.1.2.4.70":[o],"1.2.840.10008.1.2.4.80":[o],"1.2.840.10008.1.2.4.81":[o],"1.2.840.10008.1.2.4.90":[o],"1.2.840.10008.1.2.4.91":[o],"1.2.840.10008.1.2.4.92":[o],"1.2.840.10008.1.2.4.93":[o],"1.2.840.10008.1.2.4.100":[o],"1.2.840.10008.1.2.4.101":[o],"1.2.840.10008.1.2.4.102":[o],"1.2.840.10008.1.2.4.103":[o],"1.2.840.10008.1.2.4.104":[o],"1.2.840.10008.1.2.4.105":[o],"1.2.840.10008.1.2.4.106":[o]},l=r;return r||(l=[{mediaType:o}]),s.Accept=e._buildMultipartAcceptHeaderFieldValue(l,c),this._httpGet(t,s,"arraybuffer",i,a)}},{key:"_httpGetMultipartApplicationOctetStream",value:function(t,r,n,i,s,o){var c={},l={"1.2.840.10008.1.2.1":a(Object.values(v))},u=r;return r||(u=[{mediaType:"application/octet-stream"}]),n&&(c.Range=e._buildRangeHeaderFieldValue(n)),c.Accept=e._buildMultipartAcceptHeaderFieldValue(u,l),this._httpGet(t,c,"arraybuffer",s,o)}},{key:"_httpPost",value:function(e,t,r,n,i,a){return this._httpRequest(e,"post",t,{data:r,progressCallback:n,withCredentials:i,request:a})}},{key:"_httpPostApplicationJson",value:function(e,t,r,n){var i={"Content-Type":v.DICOM_JSON};return this._httpPost(e,i,t,r,n)}},{key:"searchForStudies",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m("search for studies");var r=!1,n="".concat(this.qidoURL,"/studies");return"queryParams"in t&&(n+=e._parseQueryParameters(t.queryParams)),"withCredentials"in t&&t.withCredentials&&(r=t.withCredentials),this._httpGetApplicationJson(n,{},!1,r)}},{key:"retrieveStudyMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of study metadata");m("retrieve metadata of study ".concat(e.studyInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/metadata"),r=!1;return"withCredentials"in e&&e.withCredentials&&(r=e.withCredentials),this._httpGetApplicationJson(t,{},!1,r)}},{key:"searchForSeries",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.qidoURL;"studyInstanceUID"in t&&(m("search series of study ".concat(t.studyInstanceUID)),r+="/studies/".concat(t.studyInstanceUID)),r+="/series","queryParams"in t&&(r+=e._parseQueryParameters(t.queryParams));var n=!1;return"withCredentials"in t&&t.withCredentials&&(n=t.withCredentials),this._httpGetApplicationJson(r,{},!1,n)}},{key:"retrieveSeriesMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of series metadata");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required for retrieval of series metadata");m("retrieve metadata of series ".concat(e.seriesInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/series/").concat(e.seriesInstanceUID,"/metadata"),r=!1;return"withCredentials"in e&&e.withCredentials&&(r=e.withCredentials),this._httpGetApplicationJson(t,{},!1,r)}},{key:"searchForInstances",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.qidoURL,n=!1;return"studyInstanceUID"in t?(r+="/studies/".concat(t.studyInstanceUID),"seriesInstanceUID"in t?(m("search for instances of series ".concat(t.seriesInstanceUID)),r+="/series/".concat(t.seriesInstanceUID)):m("search for instances of study ".concat(t.studyInstanceUID))):m("search for instances"),r+="/instances","queryParams"in t&&(r+=e._parseQueryParameters(t.queryParams)),"withCredentials"in t&&t.withCredentials&&(n=t.withCredentials),this._httpGetApplicationJson(r,{},!1,n)}},{key:"buildInstanceWadoURIUrl",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required.");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required.");if(!("sopInstanceUID"in e))throw new Error("SOP Instance UID is required.");var t=e.contentType||v.DICOM,r=e.transferSyntax||"*",n=[];n.push("requestType=WADO"),n.push("studyUID=".concat(e.studyInstanceUID)),n.push("seriesUID=".concat(e.seriesInstanceUID)),n.push("objectUID=".concat(e.sopInstanceUID)),n.push("contentType=".concat(t)),n.push("transferSyntax=".concat(r));var i=n.join("&");return"".concat(this.wadoURL,"?").concat(i)}},{key:"retrieveInstanceMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of instance metadata");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required for retrieval of instance metadata");if(!("sopInstanceUID"in e))throw new Error("SOP Instance UID is required for retrieval of instance metadata");m("retrieve metadata of instance ".concat(e.sopInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/series/").concat(e.seriesInstanceUID,"/instances/").concat(e.sopInstanceUID,"/metadata"),r=!1;return"withCredentials"in e&&e.withCredentials&&(r=e.withCredentials),this._httpGetApplicationJson(t,{},!1,r)}},{key:"retrieveInstanceFrames",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of instance frames");m("retrieve frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString()),n=t.mediaTypes,i=!1;"withCredentials"in t&&t.withCredentials&&(i=t.withCredentials);var a=!1;if("progressCallback"in t&&(a=t.progressCallback),!n)return this._httpGetMultipartApplicationOctetStream(r,!1,!1,!1,a,i);if(e._getSharedMediaTypes(n).length>1){var s={Accept:e._buildMultipartAcceptHeaderFieldValue(n,{"1.2.840.10008.1.2.1":["application/octet-stream"],"1.2.840.10008.1.2.5":["image/x-dicom-rle"],"1.2.840.10008.1.2.4.50":["image/jpeg"],"1.2.840.10008.1.2.4.51":["image/jpeg"],"1.2.840.10008.1.2.4.57":["image/jpeg"],"1.2.840.10008.1.2.4.70":["image/jpeg"],"1.2.840.10008.1.2.4.80":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.81":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.90":["image/jp2"],"1.2.840.10008.1.2.4.91":["image/jp2"],"1.2.840.10008.1.2.4.92":["image/jpx"],"1.2.840.10008.1.2.4.93":["image/jpx"],"1.2.840.10008.1.2.4.201":["image/jhc"],"1.2.840.10008.1.2.4.202":["image/jhc"]})};return this._httpGet(r,s,"arraybuffer",a,i)}var o=e._getCommonMediaType(n);if(o.startsWith("application"))return this._httpGetMultipartApplicationOctetStream(r,n,!1,!1,a,i);if(o.startsWith("image"))return this._httpGetMultipartImage(r,n,!1,!1,!1,a,i);if(o.startsWith("video"))return this._httpGetMultipartVideo(r,n,!1,!1,!1,a,i);throw new Error("Media type ".concat(o," is not supported for retrieval of frames."))}},{key:"retrieveInstanceRendered",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/rendered"),n=t.mediaTypes,i=t.queryParams,a=!1;"withCredentials"in t&&t.withCredentials&&(a=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return i&&(r+=e._parseQueryParameters(i)),this._httpGet(r,{},"arraybuffer",s,a);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,i,s,a);if(o.startsWith("video"))return this._httpGetVideo(r,n,i,s,a);if(o.startsWith("text"))return this._httpGetText(r,n,i,s,a);if(o===v.PDF)return this._httpGetApplicationPdf(r,i,s,a);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered instance.")}},{key:"retrieveInstanceThumbnail",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/thumbnail"),n=t.mediaTypes,i=t.queryParams,a=!1;"withCredentials"in t&&t.withCredentials&&(a=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return i&&(r+=e._parseQueryParameters(i)),this._httpGet(r,{},"arraybuffer",s,a);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,i,s,a);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered instance.")}},{key:"retrieveInstanceFramesRendered",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of rendered instance frames");m("retrieve rendered frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString(),"/rendered"),n=t.mediaTypes,i=t.queryParams,a=!1;"withCredentials"in t&&t.withCredentials&&(a=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return i&&(r+=e._parseQueryParameters(i)),this._httpGet(r,{},"arraybuffer",!1,a);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,i,s,a);if(o.startsWith("video"))return this._httpGetVideo(r,n,i,s,a);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered frame.")}},{key:"retrieveInstanceFramesThumbnail",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of rendered instance frames");console.debug("retrieve rendered frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString(),"/thumbnail"),n=t.mediaTypes,i=t.queryParams,a=!1;"withCredentials"in t&&t.withCredentials&&(a=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return i&&(r+=e._parseQueryParameters(i)),this._httpGet(r,{},"arraybuffer",s,a);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,i,s,a);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered frame.")}},{key:"retrieveInstance",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID),n=t.mediaTypes,i=t.withCredentials,a=void 0!==i&&i,s=t.progressCallback,o=void 0!==s&&s;if(!n)return this._httpGetMultipartApplicationDicom(r,!1,!1,o,a).then(h);var c=e._getCommonMediaType(n);if(c===v.DICOM)return this._httpGetMultipartApplicationDicom(r,n,!1,o,a).then(h);throw new Error("Media type ".concat(c," is not supported for retrieval of instance."))}},{key:"retrieveSeries",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID),n=t.mediaTypes,i=!1;"withCredentials"in t&&t.withCredentials&&(i=t.withCredentials);var a=!1;if("progressCallback"in t&&(a=t.progressCallback),!n)return this._httpGetMultipartApplicationDicom(r,!1,!1,a,i);var s=e._getCommonMediaType(n);if(s===v.DICOM)return this._httpGetMultipartApplicationDicom(r,n,!1,a,i);throw new Error("Media type ".concat(s," is not supported for retrieval of series."))}},{key:"retrieveStudy",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID),n=t.mediaTypes,i=t.withCredentials,a=void 0!==i&&i,s=t.progressCallback,o=void 0!==s&&s;if(!n)return this._httpGetMultipartApplicationDicom(r,!1,!1,o,a);var c=e._getCommonMediaType(n);if(c===v.DICOM)return this._httpGetMultipartApplicationDicom(r,n,!1,o,a);throw new Error("Media type ".concat(c," is not supported for retrieval of study."))}},{key:"retrieveBulkData",value:function(t){if(!("BulkDataURI"in t))throw new Error("BulkDataURI is required.");var r=t.BulkDataURI,n=t.mediaTypes,i=t.byteRange,a=t.withCredentials,s=void 0!==a&&a,o=t.progressCallback,c=void 0!==o&&o;if(-1!==this.singlepart.indexOf("bulkdata"))return this._httpGet(r,t.headers,"arraybuffer",null,s);if(n)try{if("image/"===e._getCommonMediaType(n))return this._httpGetMultipartImage(r,n,i,!1,!1,c,s)}catch(e){}return this._httpGetMultipartApplicationOctetStream(r,n,i,!1,c,s)}},{key:"storeInstances",value:function(e){if(!("datasets"in e))throw new Error("datasets are required for storing");var t="".concat(this.stowURL,"/studies");"studyInstanceUID"in e&&(t+="/".concat(e.studyInstanceUID));var r=u(e.datasets),n=r.data,i=r.boundary,a={"Content-Type":'multipart/related; type="application/dicom"; boundary="'.concat(i,'"')},s=e.withCredentials,o=void 0!==s&&s;return this._httpPost(t,a,n,e.progressCallback,o,e.request)}}],s=[{key:"_parseQueryParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="?";return Object.keys(e).forEach((function(r,n){0!==n&&(t+="&"),t+="".concat(r,"=").concat(encodeURIComponent(e[r]))})),t}},{key:"_assertMediaTypeIsValid",value:function(e){if(!e)throw new Error("Not a valid media type: ".concat(e));var t=e.indexOf("/");if(-1===t)throw new Error("Not a valid media type: ".concat(e));var r=e.slice(0,t);if(!["application","image","text","video"].includes(r))throw new Error("Not a valid media type: ".concat(e));if(e.slice(t+1).includes("/"))throw new Error("Not a valid media type: ".concat(e))}},{key:"_parseMediaType",value:function(t){return e._assertMediaTypeIsValid(t),t.split("/")}},{key:"_buildAcceptHeaderFieldValue",value:function(t,r){if(!Array.isArray(t))throw new Error("Acceptable media types must be provided as an Array");return t.map((function(t){var n=t.mediaType;if(e._assertMediaTypeIsValid(n),!r.includes(n))throw new Error("Media type ".concat(n," is not supported for requested resource"));return n})).join(", ")}},{key:"_buildMultipartAcceptHeaderFieldValue",value:function(t,r){var n=this;if(!Array.isArray(t))throw new Error("Acceptable media types must be provided as an Array");if(!Array.isArray(r)&&!f(r))throw new Error("Supported media types must be provided as an Array or an Object");var i=[];if(t.forEach((function(t){var a=t.transferSyntaxUID,s=t.mediaType;e._assertMediaTypeIsValid(s);var o='multipart/related; type="'.concat(s,'"');if(f(r)){if(!(Object.values(r).flat(1).includes(s)||s.endsWith("/*")&&s.endsWith("/")))return void m("Media type ".concat(s," is not supported for requested resource"));if(a){if("*"!==a){if(!Object.keys(r).includes(a))throw new Error("Transfer syntax ".concat(a," is not supported for requested resource"));var c=r[a];if(!c.includes(s)){var l=e._parseMediaType(s)[0];c.map((function(t){var r=e._parseMediaType(t)[0];if(l!==r||!s.endsWith("/*")&&!s.endsWith("/"))throw new Error("Transfer syntax ".concat(a," is not supported for requested resource"))}))}}o+="; transfer-syntax=".concat(a)}}else if(Array.isArray(r)&&!r.includes(s))return void(n.verbose&&console.warn("Media type ".concat(s," is not supported for requested resource")));i.push(o)})),!i.length)throw new Error("No acceptable media types found among ".concat(JSON.stringify(t)));return i.join(", ")}},{key:"_buildRangeHeaderFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 1===e.length?"bytes=".concat(e[0],"-"):2===e.length?"bytes=".concat(e[0],"-").concat(e[1]):"bytes=0-"}},{key:"_getSharedMediaTypes",value:function(t){var r=new Set;return t&&t.length?(t.forEach((function(t){var n=t.mediaType,i=e._parseMediaType(n)[0];r.add("".concat(i,"/"))})),Array.from(r)):r}},{key:"_getCommonMediaType",value:function(t){if(!t||!t.length)throw new Error("No acceptable media types provided");var r=e._getSharedMediaTypes(t);if(0===r.length)throw new Error("No common acceptable media type could be identified.");if(r.length>1)throw new Error("Acceptable media types must have the same type.");return r[0]}}],r&&i(t.prototype,r),s&&i(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()}},94614:(e,t,r)=>{r.d(t,{S_:()=>b});var n=r(76805),i=r(80107),a=r(84067),s=r(25539),o=r(43001),c=(r(8339),"object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()});function l(e){cancelAnimationFrame(e.id)}function u(e,t){var r=c();var n={id:requestAnimationFrame((function i(){c()-r>=t?e.call(null):n.id=requestAnimationFrame(i)}))};return n}var d=-1;function f(e){if(void 0===e&&(e=!1),-1===d||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),d=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return d}var p=null;function h(e){if(void 0===e&&(e=!1),null===p||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?p="positive-descending":(t.scrollLeft=1,p=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),p}return p}var v=function(e,t){return e};function m(e){var t,r=e.getItemOffset,c=e.getEstimatedTotalSize,d=e.getItemSize,p=e.getOffsetForIndexAndAlignment,m=e.getStartIndexForOffset,I=e.getStopIndexForStartIndex,y=e.initInstanceProps,w=e.shouldResetStyleCacheOnItemSizeChange,S=e.validateProps;return t=function(e){function t(t){var n;return(n=e.call(this,t)||this)._instanceProps=y(n.props,(0,i.Z)(n)),n._outerRef=void 0,n._resetIsScrollingTimeoutId=null,n.state={instance:(0,i.Z)(n),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof n.props.initialScrollOffset?n.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},n._callOnItemsRendered=void 0,n._callOnItemsRendered=(0,s.Z)((function(e,t,r,i){return n.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:r,visibleStopIndex:i})})),n._callOnScroll=void 0,n._callOnScroll=(0,s.Z)((function(e,t,r){return n.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:r})})),n._getItemStyle=void 0,n._getItemStyle=function(e){var t,i=n.props,a=i.direction,s=i.itemSize,o=i.layout,c=n._getItemStyleCache(w&&s,w&&o,w&&a);if(c.hasOwnProperty(e))t=c[e];else{var l=r(n.props,e,n._instanceProps),u=d(n.props,e,n._instanceProps),f="horizontal"===a||"horizontal"===o,p="rtl"===a,h=f?l:0;c[e]=t={position:"absolute",left:p?void 0:h,right:p?h:void 0,top:f?0:l,height:f?"100%":u,width:f?u:"100%"}}return t},n._getItemStyleCache=void 0,n._getItemStyleCache=(0,s.Z)((function(e,t,r){return{}})),n._onScrollHorizontal=function(e){var t=e.currentTarget,r=t.clientWidth,i=t.scrollLeft,a=t.scrollWidth;n.setState((function(e){if(e.scrollOffset===i)return null;var t=n.props.direction,s=i;if("rtl"===t)switch(h()){case"negative":s=-i;break;case"positive-descending":s=a-r-i}return s=Math.max(0,Math.min(s,a-r)),{isScrolling:!0,scrollDirection:e.scrollOffset<s?"forward":"backward",scrollOffset:s,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._onScrollVertical=function(e){var t=e.currentTarget,r=t.clientHeight,i=t.scrollHeight,a=t.scrollTop;n.setState((function(e){if(e.scrollOffset===a)return null;var t=Math.max(0,Math.min(a,i-r));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._outerRefSetter=function(e){var t=n.props.outerRef;n._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},n._resetIsScrollingDebounced=function(){null!==n._resetIsScrollingTimeoutId&&l(n._resetIsScrollingTimeoutId),n._resetIsScrollingTimeoutId=u(n._resetIsScrolling,150)},n._resetIsScrolling=function(){n._resetIsScrollingTimeoutId=null,n.setState({isScrolling:!1},(function(){n._getItemStyleCache(-1,null)}))},n}(0,a.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return g(e,t),S(e),null};var b=t.prototype;return b.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},b.scrollToItem=function(e,t){void 0===t&&(t="auto");var r=this.props,n=r.itemCount,i=r.layout,a=this.state.scrollOffset;e=Math.max(0,Math.min(e,n-1));var s=0;if(this._outerRef){var o=this._outerRef;s="vertical"===i?o.scrollWidth>o.clientWidth?f():0:o.scrollHeight>o.clientHeight?f():0}this.scrollTo(p(this.props,e,t,a,this._instanceProps,s))},b.componentDidMount=function(){var e=this.props,t=e.direction,r=e.initialScrollOffset,n=e.layout;if("number"==typeof r&&null!=this._outerRef){var i=this._outerRef;"horizontal"===t||"horizontal"===n?i.scrollLeft=r:i.scrollTop=r}this._callPropsCallbacks()},b.componentDidUpdate=function(){var e=this.props,t=e.direction,r=e.layout,n=this.state,i=n.scrollOffset;if(n.scrollUpdateWasRequested&&null!=this._outerRef){var a=this._outerRef;if("horizontal"===t||"horizontal"===r)if("rtl"===t)switch(h()){case"negative":a.scrollLeft=-i;break;case"positive-ascending":a.scrollLeft=i;break;default:var s=a.clientWidth,o=a.scrollWidth;a.scrollLeft=o-s-i}else a.scrollLeft=i;else a.scrollTop=i}this._callPropsCallbacks()},b.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&l(this._resetIsScrollingTimeoutId)},b.render=function(){var e=this.props,t=e.children,r=e.className,i=e.direction,a=e.height,s=e.innerRef,l=e.innerElementType,u=e.innerTagName,d=e.itemCount,f=e.itemData,p=e.itemKey,h=void 0===p?v:p,m=e.layout,g=e.outerElementType,I=e.outerTagName,y=e.style,w=e.useIsScrolling,S=e.width,b=this.state.isScrolling,D="horizontal"===i||"horizontal"===m,U=D?this._onScrollHorizontal:this._onScrollVertical,_=this._getRangeToRender(),C=_[0],T=_[1],P=[];if(d>0)for(var M=C;M<=T;M++)P.push((0,o.createElement)(t,{data:f,key:h(M,f),index:M,isScrolling:w?b:void 0,style:this._getItemStyle(M)}));var E=c(this.props,this._instanceProps);return(0,o.createElement)(g||I||"div",{className:r,onScroll:U,ref:this._outerRefSetter,style:(0,n.Z)({position:"relative",height:a,width:S,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:i},y)},(0,o.createElement)(l||u||"div",{children:P,ref:s,style:{height:D?"100%":E,pointerEvents:b?"none":void 0,width:D?E:"100%"}}))},b._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],r=e[1],n=e[2],i=e[3];this._callOnItemsRendered(t,r,n,i)}if("function"==typeof this.props.onScroll){var a=this.state,s=a.scrollDirection,o=a.scrollOffset,c=a.scrollUpdateWasRequested;this._callOnScroll(s,o,c)}},b._getRangeToRender=function(){var e=this.props,t=e.itemCount,r=e.overscanCount,n=this.state,i=n.isScrolling,a=n.scrollDirection,s=n.scrollOffset;if(0===t)return[0,0,0,0];var o=m(this.props,s,this._instanceProps),c=I(this.props,o,s,this._instanceProps),l=i&&"backward"!==a?1:Math.max(1,r),u=i&&"forward"!==a?1:Math.max(1,r);return[Math.max(0,o-l),Math.max(0,Math.min(t-1,c+u)),o,c]},t}(o.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var g=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},I=function(e,t,r){var n=e.itemSize,i=r.itemMetadataMap,a=r.lastMeasuredIndex;if(t>a){var s=0;if(a>=0){var o=i[a];s=o.offset+o.size}for(var c=a+1;c<=t;c++){var l=n(c);i[c]={offset:s,size:l},s+=l}r.lastMeasuredIndex=t}return i[t]},y=function(e,t,r,n,i){for(;n<=r;){var a=n+Math.floor((r-n)/2),s=I(e,a,t).offset;if(s===i)return a;s<i?n=a+1:s>i&&(r=a-1)}return n>0?n-1:0},w=function(e,t,r,n){for(var i=e.itemCount,a=1;r<i&&I(e,r,t).offset<n;)r+=a,a*=2;return y(e,t,Math.min(r,i-1),Math.floor(r/2),n)},S=function(e,t){var r=e.itemCount,n=t.itemMetadataMap,i=t.estimatedItemSize,a=t.lastMeasuredIndex,s=0;if(a>=r&&(a=r-1),a>=0){var o=n[a];s=o.offset+o.size}return s+(r-a-1)*i},b=m({getItemOffset:function(e,t,r){return I(e,t,r).offset},getItemSize:function(e,t,r){return r.itemMetadataMap[t].size},getEstimatedTotalSize:S,getOffsetForIndexAndAlignment:function(e,t,r,n,i,a){var s=e.direction,o=e.height,c=e.layout,l=e.width,u="horizontal"===s||"horizontal"===c?l:o,d=I(e,t,i),f=S(e,i),p=Math.max(0,Math.min(f-u,d.offset)),h=Math.max(0,d.offset-u+d.size+a);switch("smart"===r&&(r=n>=h-u&&n<=p+u?"auto":"center"),r){case"start":return p;case"end":return h;case"center":return Math.round(h+(p-h)/2);default:return n>=h&&n<=p?n:n<h?h:p}},getStartIndexForOffset:function(e,t,r){return function(e,t,r){var n=t.itemMetadataMap,i=t.lastMeasuredIndex;return(i>0?n[i].offset:0)>=r?y(e,t,i,0,r):w(e,t,Math.max(0,i),r)}(e,r,t)},getStopIndexForStartIndex:function(e,t,r,n){for(var i=e.direction,a=e.height,s=e.itemCount,o=e.layout,c=e.width,l="horizontal"===i||"horizontal"===o?c:a,u=I(e,t,n),d=r+l,f=u.offset+u.size,p=t;p<s-1&&f<d;)p++,f+=I(e,p,n).size;return p},initInstanceProps:function(e,t){var r={itemMetadataMap:{},estimatedItemSize:e.estimatedItemSize||50,lastMeasuredIndex:-1};return t.resetAfterIndex=function(e,n){void 0===n&&(n=!0),r.lastMeasuredIndex=Math.min(r.lastMeasuredIndex,e-1),t._getItemStyleCache(-1),n&&t.forceUpdate()},r},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}})}}]);
//# sourceMappingURL=5898.bundle.1a70998ac9eced2978fb.js.map